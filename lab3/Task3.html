<!-- CSE 5542 Lab3 Test -->
<!-- Jiaxin Yang.5039@osu.edu -->

<!DOCTYPE html>
<html>
  <head>
    <title>Lab_3 Task_3</title>
    <!-- <script type="text/javascript" src="d3/d3.min.js"></script>  -->
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>
    <script src="https://d3js.org/d3-geo-projection.v2.min.js"></script>
  </head>

  <body>
    <svg width="1000" height="3000"></svg>>

    <script type="text/javascript">
      //Read the data
      d3.csv("mon_sta_gen.csv", function (data) {
        console.log(data);
        var myMon = [
          "1",
          "2",
          "3",
          "4",
          "5",
          "6",
          "7",
          "8",
          "9",
          "10",
          "11",
          "12",
        ];
        var myState = ["IL", "IN", "MI", "OH", "WI"];

        // Build X scales and axis:
        var x = d3.scaleBand().range([0, 800]).domain(myMon).padding(0.03);
        d3.select("svg")
          .append("g")
          .style("font-size", 15)
          .attr("transform", "translate(50,430)")
          .call(d3.axisBottom(x).tickSize(0))
          .select(".domain")
          .remove();

        // Build Y scales and axis:
        var y = d3.scaleBand().range([330, 0]).domain(myState).padding(0.01);
        d3.select("svg")
          .append("g")
          .style("font-size", 15)
          .attr("transform", "translate(50,100)")
          .call(d3.axisLeft(y).tickSize(0))
          .select(".domain")
          .remove();

        // Build color scale
        var myColor = d3
          .scaleSequential()
          .interpolator((t) => d3.interpolateRdBu(1 - t))
          .domain(
            d3.extent(data, function (d) {
              return d.GENERATION;
            })
          );

        d3.select("svg")
          .append("g")
          .selectAll()
          .data(data, function (d) {
            return d.MONTH + ":" + d.STATE;
          })
          .enter()
          .append("rect")
          .attr("transform", "translate(50,100)")
          .attr("x", function (d) {
            return x(d.MONTH);
          })
          .attr("y", function (d) {
            return y(d.STATE);
          })
          .attr("width", x.bandwidth())
          .attr("height", y.bandwidth())
          .style("fill", function (d) {
            return myColor(d.GENERATION);
          });
      });

      d3.select("svg")
        .append("g")
        // title
        .append("text")
        .text("2021 Monthly Electricity Generation Heatmap")
        .attr("transform", "translate(200, 80)");
    </script>
  </body>
</html>
