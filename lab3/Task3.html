<!-- CSE 5542 Lab3 Test -->
<!-- Jiaxin Yang.5039@osu.edu -->

<!DOCTYPE html>
<html>
  <head>
    <title>Lab_3 Task_2</title>
    <!-- <script type="text/javascript" src="d3/d3.min.js"></script>  -->
    <script src="https://d3js.org/d3.v4.min.js"></script>
    <script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>
  </head>

  <body>
    <svg width="1000" height="1000"></svg>>

    <script type="text/javascript">
      var data = d3.map();
      
      d3.queue()
  .defer(d3.json, "us-states.json")
  .defer(d3.csv, "state_Gen.csv", function(d) { data.set(d.STATE, +d.GENERATION); })
  .await(map);

      function map(error, topo) {
        console.log(topo)
        // Map and projection
var path = d3.geoPath();
var projection = d3.geoAlbersUsa();

var colorScale = d3.scaleThreshold()
  .domain(topo)
  .range(d3.schemeBlues[7]);


  let mouseOver = function(d) {
    d3.selectAll(".STATE")
      .transition()
      .duration(200)
      .style("opacity", 1)
    d3.select(this)
      .transition()
      .duration(200)
      .style("opacity", 1)
      .style("stroke", "black")
  }

  let mouseLeave = function(d) {
    d3.selectAll(".STATE")
      .transition()
      .duration(200)
      .style("opacity", .7)
    d3.select(this)
      .transition()
      .duration(200)
      .style("stroke", "transparent")
  }

  // Draw the map
  d3.select("svg")
          .append("g")
    .selectAll("path")
    .data(topo.features)
    .enter()
    .append("path")
      // draw each state
      .attr("d", d3.geoPath()
        .projection(projection)
      )
      // set the color of each country
      .attr("fill", function (d) {
        d.total = data.get(d.name) || 0;
        return colorScale(d.total);
      })
      .style("stroke", "transparent")
      .attr("class", function(d){ return "STATE" } )
      .style("opacity", .7)
      .on("mouseover", mouseOver )
      .on("mouseleave", mouseLeave )
    }

      
    </script>
  </body>
</html>
